<!DOCTYPE html>
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
		<title>AutoComplete Prototype</title>
		<link type="text/css" href="lib/smoothness/jquery-ui-1.8.16.custom.css" rel="stylesheet" />	
		<script type="text/javascript" src="lib/jquery-1.6.2.min.js"></script>
		<script type="text/javascript" src="lib/jquery-ui-1.8.16.custom.min.js"></script>
		<script type="text/javascript" src="../../js/config.js"></script>
		<script type="text/javascript" src="../../js/query.js"></script>
        <script type="text/javascript" src="lib/jquery.ui.autocomplete.html.js"></script>
		<style type="text/css">
		</style>	
	</head>
	<body>
        <script>
            $(function() {
                function autocompleteUpdate(callback, code, response, duration) {
                    $("#duration").text(duration + "ms");
                    if(!success(code)) {
                        alert('query failed\n' + response);
                        callback([]);
                        return;
                    }
                    var items = [];
                    var raw = response.slice(0,2 * 15);
                    var makeItem = function(x) {
                        return x.resolved_ + " (" + x.score_ + ")";
                    }
                    for(var i = 0; i < raw.length; i += 2) {
                        
                        items.push(
                            "<table width='100%'><tr><td width='50%'>" +
                            makeItem(raw[i]) +
                            "</td><td width='50%'>" +
                            makeItem(raw[i + 1]) +
                            "</td></tr></table>"
                        );
                    }
                    callback(items);
                }

                $( "#query" ).autocomplete(
                    {
                        source:function(req, resp) {
                            var xhr = buildXHR("GET", "/api/autocomplete/term/" + req.term, autocompleteUpdate.bind(undefined, resp));
                            xhr.send(null);                
                        },
                        appendTo:$("#term-completes"),
                        html:true
                    }
                );
            });
        </script>

        <div class="demo">
            <div class="grid-autocomplete ui-widget">
                <label for="query">Query: </label>
                <input id="query">Duration: <span id="duration"></span>
            </div>
        </div>     
        <div id="term-completes"></div>
        
        
	</body>
</html>


